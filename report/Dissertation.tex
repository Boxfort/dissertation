%You can delete all the comments after you have finished your document
%this sets up the defaults for the documents, 12pt font and A4 size. The article type sets this up as such as opposed to letter or memo.
%for the finer points LaTeX see https://en.wikibooks.org/wiki/LaTeX or http://tex.stackexchange.com/

\documentclass[12pt,a4paper]{article}
\usepackage{titlesec} %these are how we import packages, one helps set up footers and title layout
\usepackage{fancyhdr}

% !TEX TS-program = pdflatex
% !TEX encoding = UTF-8 Unicode
\usepackage[utf8]{inputenc} % set input encoding (not needed with XeLaTeX)
%\usepackage[margin=3.5cm]{geometry}

\usepackage{graphicx} % support the \includegraphics command and options

% \usepackage[parfill]{parskip} % Activate to begin paragraphs with an empty line rather than an indent

%%% PACKAGES
\usepackage{booktabs} % for much better looking tables
\usepackage{array} % for better arrays (eg matrices) in maths
\usepackage{paralist} % very flexible & customisable lists (eg. enumerate/itemize, etc.)
\usepackage{verbatim} % adds environment for commenting out blocks of text & for better verbatim
\usepackage{subfig} % make it possible to include more than one captioned figure/table in a single float
\usepackage[british]{babel}
\usepackage[style=apa,backend=biber]{biblatex}
\DeclareLanguageMapping{british}{british-apa}
\usepackage[toc,page]{appendix}
% These packages are all incorporated in the memoir class to one degree or another...

\usepackage{tikz}
\usetikzlibrary{matrix,chains,positioning,decorations.pathreplacing,arrows}

% MY PACKAGES
\usepackage{adjustbox}
\usepackage{pdfpages}
\usepackage{pgfplots}
\usepackage{multicol}
\usepackage{float}
\usepackage{blindtext}
\usepackage{longtable}

\makeatletter
\renewcommand\paragraph{\@startsection{paragraph}{4}{\z@}%
            {-2.5ex\@plus -1ex \@minus -.25ex}%
            {1.25ex \@plus .25ex}%
            {\normalfont\normalsize\bfseries}}
\makeatother

\setcounter{secnumdepth}{4} % how many sectioning levels to assign numbers to
\setcounter{tocdepth}{4}    % how many sectioning levels to show in ToC


%header and footer settings
\pagestyle{fancyplain}
\fancyhf{}
\renewcommand{\headrulewidth}{0.5pt}
\renewcommand{\footrulewidth}{0.5pt}
\setlength{\headheight}{15pt}
\fancyhead[L]{Jack Anderson - 40208539}
\fancyhead[R]{ SOC10101 Honours Project}
\fancyfoot[L]{}
\fancyfoot[C]{\thepage}

%set better section layout
\makeatletter
\renewcommand\subsection{\@startsection {subsection}{1}{2mm} % name, level, indent
                               {3pt plus 2pt minus 1pt} % before skip
                               {3pt plus 0pt} % after skip
                               {\normalfont\bfseries}}
\makeatother
\makeatletter
\renewcommand\section{\@startsection {section}{1}{0mm} % name, level, indent
                               {4pt plus 2pt minus 1pt} % before skip
                               {4pt plus 0pt} % after skip
                               {\bfseries}}
\makeatother

\addbibresource{bibliography.bib}

%this starts the document
\begin{document}

%you can import other documents into your main one, these layout the Title and Declarations on its own page.
%you might need to change these to \ if your on Microsoft Windows.
\input{./Dissertation-Title.tex}
\input{./Dissertation-Dec.tex}
\pagebreak
\input{./Dissertation-DP.tex}
\pagebreak

%LaTeX let you define the abstract separately so it wont get sucked into the main document.
\begin{abstract}
% fill the abstract in here
\end{abstract}
\pagebreak

\tableofcontents % is generated for you
\newpage

\listoftables
%generated in same way as figures
\newpage

\listoffigures
%you may have captions such as equations, listings etc they should all appear as required
%these are done for you as long as you use \begin{figure}[placement settings] .. bla bla ... \end{figure}
\newpage

\section*{Acknowledgements}
Insert acknowledgements here
\newpage

\section{Introduction}
\subsection{Background}
	For any major company or business security is of the utmost concern, with a study finding that in the UK in 2016 an estimated 46\% of all businesses experienced a cyber security breach or attack \cite{securitysurvey2017}. These breaches are particularly dangerous as even if a network is compromised a single time a company can have its entire database destroyed, or customer data leaked, leading to legal repercussions. When it comes to preventing these intrusions firewalls alone are insufficient for anything but the most rudimentary of attacks and so a Network Intrusion Detection System (NIDS) is employed to further bolster the security of the network. Traditional NIDS are placed strategically on a network to monitor all incoming traffic. It analyses the passing traffic and then compares it to a large library of known attacks and if it matches will flag the traffic. While these systems do provide some degree of protection they are unable to detect novel attacks or zero-day vulnerabilities and so some other method of identifying suspicious traffic is required. Introducing machine learning to a NIDS is one way of attempting to solve this problem first proposed by \cite{denning1987intrusion}. In using machine learning to detect network intrusions the system can be trained to recognise patterns of intrusive behaviour, allowing it to detect attacks which it may not have seen before but have characteristics of similar attacks. Machine learning also allows systems to be easily retrained to accommodate for new data on attacks as it emerges. There are two main categories of NIDS: misuse detection, and anomaly detection; both of which have their own advantages and disadvantages. This literary review aims to discuss the different kinds of network intrusion detection systems, the algorithms that these systems employ, and the gap in papers which directly compare the performance of single stage and two-stage classifiers in the domain of network intrusion detection.
		
\subsection{Research Questions}
	For this honours thesis there are a number of research questions which have been collated, and an attempt made to answer them. These questions in which I am interested in answering are the following: 
		
		\begin{itemize}
			\item What is the rate of accurate detection and classification of network intrusions by single stage machine learning classification methods?
			\item What is the rate of accurate detection and classification of network intrusions by two stage machine learning classification methods?
			\item Which method of classification i.e. single stage or two stage, is more accurate and by what amount?
			\item Which configuration of algorithms in the two stage classifier produces the most accurate results?
		\end{itemize}
		
In this context, accuracy is defined as a high number of true positives and true negatives, and a low number of false positives and false negatives when classifying network intrusions. \\

	First research will be completed in order to gain an understanding of the history and current state of machine learning for network intrusion detection, through reading relevant research papers and articles. Next the individual algorithms and methods which go into detecting network intrusions will be researched and understood. This knowledge will then be put into developing a piece of software capable of running these algorithms and extracting metrics which will be used to answer these research questions.

\subsection{Aims and Objectives}
	The aim of this project is to create a piece of software which is capable of running both single and two stage classification algorithm arrangements on a number of datasets and displaying the results in a clear manner. In doing so this will assist in answering the research questions put forward.

	These research questions, specifically whether or not two stage classification provides more accurate results than single stage classification will be answered by meeting the following objectives:
\begin{itemize}
\item{Perform a review of existing literature.}
\item{Perform a review of existing software.}
\item{Select appropriate machine learning classification algorithms.}
\item{Select appropriate datasets for use in network intrusion detection.}
\item{Implementation of software to assist in comparison of classification algorithms.}
\item{Evaluation of software with regards to specification and other software.}
\item{Evaluation of classification algorithm performance.}
\end{itemize}

\subsection{Scope and Limitations}
	\subsubsection{Deliverables}
	The list of deliverables for this project are the following:
	\begin{itemize}
	\item{A review of literature on related topics and a report detailing the findings of such reports.}
	\item{A review of existing software which performs a similar role to the proposed software.}
	\item{A software requirement specification.}
	\item{A description of all testing which will be carried out.}
	\item{A report detailing the results of each classification algorithm and configuration of two stage classification algorithms}
	\item{An evaluation of the implemented software with regards to how well it meets the proposed specification, and how it compares to existing software.}
	\end{itemize}
	\subsubsection{Boundaries}
	There exists a large number of different classification algorithms and methods to perform network intrusion detection, therefore this project must focus on a few specifically. This project will focus on performing misuse detection rather than anomaly detection, and will limit the classification algorithms used to: k-Nearest Neighbour, Multi-layer Perceptron, and a Support Vector Machine.
	\subsubsection{Constraints}
	The largest constraint facing this project is that of time. There is a large amount of literature to be reviewed, and also a considerable amount of results which must be collected and results drawn from in a short amount of time.
	Time
	Knowledge
	Misuse detection only
\subsection{Structure of this Dissertation}
This dissertation can be divided into three main parts. Part one is literature review and past projects within the field, and existing software. Second part details the planning design and implementation of the software and the third consists of an analysis and evaluation of results and software.

part one reviews the literature on the subject and examines results of past projects and individual algorithms, also reviews existing software for machine learning comparison.

part two describes the detailed software requirements and specific functionality which should be implemented. Also includes a description of technologies and libraries used, and a testing plan. 

part three is an evaluation of the final software product against its design. Analysis and evaluation of classifier results. also has an evaluation of the overall project how well it met its aims and suggestions for future work.

\input{Dissertation-LR}

\section{Existing Software}
\subsection{WEKA}
\subsection{SPLUNK}
\section{Software}
This section of the report will provide a high level description of the functionality and requirements of the software as well as describing the role of the user which will interact with the system. Detailed descriptions of functionality will also be included, and a list of hardware and software constraints, dependencies and assumptions made about the system and users. A detailed testing description will then be given outlining any and all unit testing and functional testing which will take place. Finally an evaluation will take place assessing how well the produced software meets its initial requirements and design.
\subsection{Overall Description}
\subsubsection{Product Perspective}
\subsubsection{Product Functions}
\subsubsection{User Characteristics}
This software is primarily focused towards researchers and students interested in comparing machine learning classification algorithms with a single stage against those with multiple stages. The software may be used by them in order to quickly make comparisons between different configurations of classifiers and to assess the effectiveness of these configurations. They will be able to enter their own datasets and classifiers and receive results in a standard format, and to view these results in a graph.
\subsubsection{Operating Environment}
In order to run the software the following requirements must be met:
\begin{itemize}
	\item{Python 3.6.4+ with the following packages:}
	\begin{itemize}
		\item{NumPy 1.14.0+}
		\item{Pandas 0.22.0+}
		\item{Pandas-ml 0.5.0+}
		\item{Scikit-learn 0.19.1+}
		\item{Scipy 1.0.0}
		\item{Matplotlib 2.1.1+}
		\item{PyQt 5.9.1+}
	\end{itemize}
\item{One of the following operating systems:}
	\begin{itemize}
		\item{Windows 7 (x86) or greater}
		\item{macOS 10.11 or greater}
		\item{Linux with X11}
	\end{itemize}
	\item{A system capable of running one of the above operating systems.}
\end{itemize}

\subsection{Specific Requirements}
\subsubsection{User Interface}
\begin{figure}[H]
	\makebox[\textwidth][c]{\includegraphics[width=\textwidth, center]{figures/Mainwindow.pdf}}
\caption{Main Window Result Tab Wireframe}
\label{mainwf}
\end{figure}
\begin{figure}[H]
	\makebox[\textwidth][c]{\includegraphics[width=\textwidth, center]{figures/mainwindowgraph.pdf}}
\caption{Main Window Graph Tab Wireframe}
\label{graphwf}
\end{figure}
\begin{figure}[H]
	\makebox[\textwidth][c]{\includegraphics[width=\textwidth, center]{figures/datasetwindow.pdf}}
\caption{Dataset Window Wireframe}
\label{datasetwf}
\end{figure}

\subsubsection{Functional Requirements}
\input{reqspec}
\subsection{Testing}
Paragraph about testing, unit testing and why
\input{tables/testcase.tex}

\section{Methodology}
\subsection{Implementation}
\subsubsection{PyQt}
What is PyQT \parencite{pyqt5}
Why PyQT
	Cross platform
	not java so allows dev in all same language
	Extensive documentation

\subsubsection{Scikit-Learn}
What is scikit \parencite{scikit}
Why
	Pre implemented algorithms ensure correctness and save time
	Provides methods for scaling data
	Provides methods for generating Confusion matrices and producing classification reports quickly.

\subsubsection{Pandas}
hat is pandas \parencite{pandas}
Why
	Its the best

\subsubsection{Matplotlib}
What is matplot \parencite{matplotlib}
why
	works with pyqt
	powerfull
	lots of usefull info online
\subsubsection{Software}
The software which was written is described with a class diagram, seen in Appendix \ref{classdiagram} specifying each distinct class created along with its methods, properties and relationship with other classes, and with a use case diagram showing the general function of the software from the perspective of the user, as seen in Appendix \ref{usecase}. A description of all of the software classes functions is as follows.
\paragraph{MainWindow}
The MainWindow class is the class which is responsible for all of the logic behind the user interface of the main window. It inherits the QMainWindow class; a PyQt type which provides a main application window, and from Ui\_MainWindow, which provides the specification and initialisation of the user interface. The classes main function is handling user input, creating new user interface elements and windows, and allowing the user to view classification results.
\paragraph{DatasetWindow}
The DatasetWindow class is primarily responsible for defining what dataset the user wishes to use, to specify the data type of each column of said dataset. The window also allows users to choose between a testing dataset or k-fold cross validation and specify a number of folds, and to specify the number of runs a stochastic classifier should be run for. This class inherits from QDialog which provides the class with buttons allowing the user to accept or cancel the information they have input. It also inherits from Ui\_DatasetWindow which like Ui\_MainWindow provides the user interface for the window.
\paragraph{UIObject}
UIObject is an interface which is used by other classes which implement a user interface for some window. It is required as when a user interface is inherited by a window class a number of methods are expected to be available in order to create and render the user interface at runtime.
\paragraph{Classifier}
Classifier is an interface which any classification algorithm which is to be used must implement. It has one property, 'stochastic', which determines whether or not the classifier must be run multiple times, and a 'run' method which carries out the classification and returns the results.
\paragraph{QClfSelector}
QClfSelector is a class which inherits from QWidget, the base class of all Qt user interface objects, and who's main function is to act as a widget that can be included within MainWindow multiple times. It provides the functionality of accepting user classifier arrangements and then fetching and running those classifiers, using whatever method has been specified by the user, be it k-fold cross validation or using a test dataset, or running stochastic classifiers multiple times and gathering the results.
\paragraph{QBarChart}
QBarChart is a class which inherits from 'FigureCanvas', a Matplotlib class which interfaces with PyQt in order to create widget which can be displayed within a PyQt application. The class accepts a set of classification results and then constructs a Matplotlib chart which can be displayed in the MainWindow class for the user to view.
\paragraph{ErrorMessage}
The ErrorMessage Class is the class responsible for displaying an error message popup to users, in a standard manner and encapsulates boiler plate code required for creating and showing a message box. The class inherits from QMessageBox which is a PyQt class provides a modal dialog for informing the user.
\subsection{Datasets}
\subsubsection{NSL-KDD}
\begin{itemize}
\item{Denial of Service (DoS) - Attacker tries to preventlegitimate users from using a service.}
\item{Remote to Local (r2l) - Attacker does not have an account on the victim machine, hence tries to gain access.}
\item{User to Root (u2r) - Attacker has local access to the victim machine and tries to gain super user privileges.}
\item{Probe - Attacker tries to gain information about the target host.}
\end{itemize}
•Remote to Local (r2l):.•User to Root (u2r):•Probe:
\input{tables/kddattacks}
\input{tables/kddbroad}
\subsubsection{UNSW-NB15}
\input{tables/unswattacks}
\subsection{Data Preprocessing}
\subsection{Two Stage Classification}
\subsection{Metrics}
\subsubsection{Precision}
\[ precision = \frac{tp}{tp+fp} \]
\subsubsection{Recall}
\[ recall = \frac{tp}{tp+fn} \]
\subsubsection{f1-Score}
\[ f_1 = \frac{2tp}{2tp+fp+fn} \]

\section{Evaulation}
\subsection{Software}
Evaluate the software
How many of the function requirements were met
How many of the non functional requirements were met
Is the user interface like it was designed
How does it compare to existing software
\subsection{k-Nearest Neighbours}
\subsection{Multi-layer Perceptron}
\subsection{Support Vector Machine}
\subsection{Single-Stage Classifiers Performance}
\subsection{Two-stage Classifiers Performance}

\section{Conclusion}
\subsection{Research Questions}
\subsubsection*{What is the rate of accurate detection and classification of network intrusions by single stage machine learning classification methods?}
\subsubsection*{What is the rate of accurate detection and classification of network intrusions by two stage machine learning classification methods?}
\subsubsection*{Which method of classification i.e. single stage or two stage, is more accurate and by what amount?}
\subsubsection*{Which configuration of algorithms in the two stage classifier produces the most accurate results?}

\subsection{Has the Project met it's Aims and Objectives?}
\subsection{Reflection}
\subsection{Learning Outcomes}
\subsection{Further Research}

\newpage
	\printbibliography
\newpage

\begin{appendices}
\section{Project Overview}

%\input{ipo}
\includepdf[pages=-]{figures/ipo}

\begin{subappendices}
\subsection{Project Timeline}

\begin{figure}[h!]
	\centering
	\includegraphics[width=1.11\textwidth,angle=90]{figures/Ganttchart}
	\caption{Project Timeline Gantt Chart}
	\label{gantt}
\end{figure}

\end{subappendices}

\newpage

\section{Second Formal Review Output}
\includepdf[pages=-]{figures/interim}

\section{Diary Sheets (or other project management evidence)}
\includepdf[page=-]{figures/diaries}

\newpage

\section{MoSCoW Analysis}
\input{tables/moscow}

\newpage

\section{Class Diagram} \label{classdiagram}
\begin{figure}[H]
	\makebox[\textwidth][c]{\includegraphics[width=1.2\textwidth, center]{figures/classuml.pdf}}
\caption{UML Class Diagram}
\end{figure}

\newpage

\section{Use Case Diagram} \label{usecase}
\begin{figure}[H]
	\makebox[\textwidth][c]{\includegraphics[width=1.2\textwidth, center]{figures/usecase.pdf}}
\caption{UML Use Case Diagram}
\end{figure}

\section{NSL-KDD Precision}
\input{tables/nslprecision}
\input{plots/precision}

\newpage


\section{NSL-KDD Recall}
\input{tables/nslrecall}
\input{plots/recall}

\newpage

\section{NSL-KDD F1-Score}
\input{tables/nslf1score}
\input{plots/f1score}

\newpage


\section{UNSW-NB15 Precision}
\input{tables/UNSWpecision}
\input{plots/precisionUNSW}

\newpage

\section{UNSW-NB15 Recall}
\input{tables/UNSWrecall}
\input{plots/recallUNSW}

\newpage

\section{UNSW-NB15 f1-Score}
\input{tables/UNSWf1score.tex}
\input{plots/f1scoreUNSW}

\newpage


\end{appendices}

\end{document}
